# 場景 5：單元測試

## 🎯 學習目標
- 學習使用自然語言生成單元測試
- 掌握 **edit mode** 批次編輯功能
- 體驗 Copilot 在測試覆蓋率提升上的效果
- 了解如何生成各種測試場景

## 📝 場景說明
您有一個包含多種功能的 JavaScript 工具庫，需要為這些函數撰寫完整的單元測試。學習如何利用 GitHub Copilot 快速生成高品質的測試程式碼。

## 🛠️ 初始專案結構
```
05-unit-testing/
├── README.md (本檔案)
├── package.json
├── src/
│   ├── calculator.js (計算器函數)
│   ├── validator.js (驗證函數)
│   ├── utils.js (工具函數)
│   └── dataProcessor.js (資料處理函數)
├── tests/
│   ├── calculator.test.js (待完成)
│   ├── validator.test.js (待完成)
│   ├── utils.test.js (待完成)
│   └── dataProcessor.test.js (待完成)
└── jest.config.js (Jest 設定)
```

## 📚 Demo 劇本

### 步驟 1：為基礎函數生成測試
1. 開啟 `src/calculator.js`
2. 選取 `add` 函數
3. 在 Copilot Chat 中輸入：
```
為這個函數生成完整的 Jest 單元測試，包含邊界條件和錯誤處理
```

### 步驟 2：使用 Edit Mode 批次生成測試
1. 按下 `Ctrl+I` 使用 inline chat
2. 選取整個 `validator.js` 檔案
3. 輸入：
```
為這個檔案中的所有函數生成對應的 Jest 測試，每個函數至少包含 3 個測試案例
```

### 步驟 3：生成複雜場景的測試
在 Chat 中輸入：
```
@workspace 為 dataProcessor.js 中的非同步函數生成測試，包含成功、失敗和邊界情況
```

### 步驟 4：測試覆蓋率分析
```
請分析這些測試是否涵蓋了所有重要的程式碼路徑，並建議補充測試
```

### 步驟 5：Mock 和 Spy 測試
```
為使用外部 API 的函數生成 mock 測試，展示如何測試副作用
```

## 💡 重點提示

### 測試生成最佳實踐：
1. **描述測試意圖**：「測試正常情況」、「測試錯誤處理」、「測試邊界條件」
2. **指定測試框架**：明確說明使用 Jest、Mocha 或其他框架
3. **包含 AAA 模式**：Arrange、Act、Assert 結構
4. **考慮測試覆蓋率**：確保關鍵路徑都有測試

### Edit Mode 使用技巧：
1. **選取範圍**：可以選取單個函數或整個檔案
2. **批次操作**：一次為多個函數生成測試
3. **保持一致性**：確保測試風格一致
4. **增量改進**：逐步完善測試內容

### 測試類型範例：
1. **單元測試**：測試個別函數的行為
2. **整合測試**：測試多個模組的互動
3. **Mock 測試**：模擬外部依賴
4. **參數化測試**：使用多組資料測試同一邏輯

## 🎬 Demo 重點
1. 展示 inline chat 快速生成測試的流程
2. 示範如何利用 @workspace 理解專案結構來生成測試
3. 強調測試品質和覆蓋率的重要性
4. 展現不同類型測試的生成技巧

## 📝 常用測試提示詞

### 基礎測試生成：
```
為這個函數生成 Jest 測試
生成包含正常情況和邊界條件的測試
為這個類生成完整的測試套件
```

### 進階測試生成：
```
生成 mock 測試來驗證外部 API 呼叫
為這個非同步函數生成測試，包含 Promise 和錯誤處理
生成參數化測試來驗證多種輸入組合
```

### 測試改進：
```
檢查這些測試的覆蓋率是否足夠
建議額外的測試案例來提高測試品質
重構這些測試以提高可讀性和維護性
```

## ✅ 預期成果
完成本場景後，您應該：
- 能夠快速為任何函數生成高品質的單元測試
- 掌握 edit mode 在測試生成上的應用
- 了解如何生成不同類型的測試（unit、integration、mock）
- 建立完整的測試套件並達到高覆蓋率

## 🔍 延伸練習
1. 為複雜的類別生成完整的測試套件
2. 生成端到端測試腳本
3. 使用 Copilot 建立測試資料產生器
4. 生成效能測試和壓力測試

## 🎯 挑戰任務
1. 達到 90% 以上的測試覆蓋率
2. 生成包含所有邊界條件的測試
3. 建立自動化測試流水線配置
4. 為現有專案補充缺失的測試