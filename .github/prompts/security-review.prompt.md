---
mode: "edit"
description: "執行程式碼安全性檢查"
---

# 程式碼安全性檢查

請對指定的程式碼進行全面的安全性審查，檢查以下安全性問題：

## 🔒 **輸入驗證和清理**
### 檢查項目：
- [ ] 所有使用者輸入是否經過適當驗證
- [ ] 是否防範 SQL Injection 攻擊
- [ ] 是否防範 XSS (Cross-Site Scripting) 攻擊
- [ ] 檔案上傳的安全性檢查
- [ ] 輸入長度和格式限制

### 常見漏洞：
- 直接執行使用者提供的 SQL 語句
- 未轉義的 HTML 輸出
- 缺少輸入型別驗證
- 路徑遍歷攻擊 (Path Traversal)

## 🛡️ **認證和授權**
### 檢查項目：
- [ ] 密碼儲存是否使用適當的雜湊演算法
- [ ] 認證邏輯是否正確實作
- [ ] 權限檢查是否完整
- [ ] Session 管理是否安全
- [ ] JWT Token 使用是否安全

### 安全要求：
- 使用 bcrypt、scrypt 或 Argon2 雜湊密碼
- 實作適當的 Session 逾時
- 檢查每個端點的權限要求
- 避免在 URL 中傳遞敏感資訊

## 🔐 **敏感資料保護**
### 檢查項目：
- [ ] 敏感資料是否加密儲存
- [ ] API 金鑰和密碼是否硬編碼
- [ ] 日誌中是否包含敏感資訊
- [ ] 錯誤訊息是否洩露敏感資訊
- [ ] HTTPS 是否正確配置

### 最佳實踐：
- 使用環境變數儲存機密資料
- 實作適當的錯誤處理
- 避免在日誌中記錄密碼或個人資料
- 確保所有傳輸都使用加密

##  **網路安全**
### 檢查項目：
- [ ] CORS 設定是否適當
- [ ] CSP (Content Security Policy) 是否設定
- [ ] 是否防範 CSRF 攻擊
- [ ] Rate Limiting 是否實作
- [ ] 安全標頭是否正確設定

### 安全標頭：
```javascript
// 必要的安全標頭
app.use(helmet({
  contentSecurityPolicy: { /* 設定 */ },
  hsts: { maxAge: 31536000 },
  noSniff: true,
  xssFilter: true
}));
```

## 💾 **資料庫安全**
### 檢查項目：
- [ ] 是否使用 ORM 或參數化查詢
- [ ] 資料庫連線是否加密
- [ ] 是否有適當的備份機制
- [ ] 敏感欄位是否加密
- [ ] 是否實作資料清理政策

## 🔧 **依賴項安全**
### 檢查項目：
- [ ] 第三方套件是否為最新版本
- [ ] 是否存在已知的安全漏洞
- [ ] 依賴項的數量是否合理
- [ ] 是否定期進行安全性掃描

### 工具建議：
- 使用 `npm audit` 檢查漏洞
- 定期更新依賴項
- 考慮使用 Snyk 或類似工具

##  **安全檢查清單**
請提供以下格式的檢查結果：

###  已通過的安全檢查
- [項目名稱]: [檢查結果]

### ⚠️ 發現的安全風險
- **風險等級**: 高/中/低
- **問題描述**: [具體問題]
- **建議修正**: [修正方案]
- **影響範圍**: [受影響的功能]

### 🔧 建議改進
- [具體的改進建議和實作方式]

請對提供的程式碼進行徹底的安全性審查。