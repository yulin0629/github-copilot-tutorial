---
mode: "agent"
description: "生成完整的 API 測試套件"
---

# API 測試生成器

請為指定的 API 端點生成完整的測試套件，遵循以下測試標準：

## 測試框架要求
- 使用 **Jest** 作為測試框架
- 使用 **supertest** 進行 HTTP 請求測試
- 包含 **setup** 和 **teardown** 邏輯

## 測試覆蓋範圍
### 1. 成功情境測試
- 有效請求的正確回應
- 資料格式驗證
- 狀態碼確認 (200, 201, 204 等)

### 2. 錯誤處理測試
- 無效輸入的錯誤回應
- 缺少必需參數
- 無效的認證
- 權限不足 (401, 403)
- 資源不存在 (404)
- 伺服器錯誤 (500)

### 3. 邊界條件測試
- 空值和 null 處理
- 超長字串輸入
- 無效的資料型別
- 極值測試

## 程式碼結構
```javascript
describe('API_ENDPOINT_NAME', () => {
  beforeEach(() => {
    // 設定測試資料
  });

  afterEach(() => {
    // 清理測試資料
  });

  describe('成功情境', () => {
    // 正常流程測試
  });

  describe('錯誤處理', () => {
    // 錯誤情境測試
  });

  describe('邊界條件', () => {
    // 邊界值測試
  });
});
```

## 測試資料管理
- 使用 **測試用的假資料**
- 避免依賴真實的外部服務
- 包含 **mock** 和 **stub** 設定
- 確保測試之間的獨立性

## 斷言要求
- 驗證 **HTTP 狀態碼**
- 檢查 **回應資料結構**
- 確認 **資料型別正確性**
- 測試 **業務邏輯正確性**

## 額外考量
- 包含 **效能測試** (回應時間)
- 加入 **並發請求測試**
- 考慮 **資料庫狀態變化**
- 包含 **日誌檢查**

請為指定的 API 端點生成全面的測試套件。